!function(t){"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&module.exports?module.exports=t():window.flipbook=t.call(this)}(function(){var t=function(t){var e,o,n,i,a,r,d,f,s,l,c,p,u,h,m,g,v=-1,b=function(){var e,o=["id","path","extension","frames"];o.forEach(function(o){t[o]||(e=o)}),t.speed=t.speed||.5,e?W("invalid options, missing "+e):(w(),k(),E(function(t){t?W(W):x()}))},x=function(){h=!0,y(),C(),R(0),e.removeChild(a)},w=function(){e=document.getElementById(t.id),e.classList.add("flipbook-container"),a=document.createElement("div"),a.classList.add("flipbook-loader"),r=document.createElement("div"),r.classList.add("flipbook-loader--progress");var d=document.createElement("div");d.classList.add("flipbook-loader--text"),d.innerText="Loading animation...",I(d,{position:"relative"}),a.appendChild(r),a.appendChild(d),e.appendChild(a),o=document.createElement("div"),o.classList.add("flipbook-graphic"),e.appendChild(o),n=L(o),i=n.getContext("2d")},k=function(){I(e,{position:"relative",width:"100%",overflow:"hidden"}),I(a,{position:"relative","text-align":"center",padding:"1em","font-family":"sans-serif",color:"#666",background:"#efefef"}),I(r,{position:"absolute","z-index":0,top:0,left:0,width:0,height:"100%",background:"#ddd"}),I(o,{position:"absolute",top:0,left:0}),I(n,{position:"absolute",top:0,left:0})},y=function(){window.addEventListener("resize",C,!1),window.addEventListener("scroll",M,!1)},E=function(e){m=[];for(var o=0;o<t.frames;o++)m[o]={src:t.path+"/"+(o+1)+"."+t.extension};var n=function(o){var i=m[o];B(i,function(a,d){a?e("error loading image"):(i.img=d,0===o&&(t.aspectRatio=Math.round(d.naturalWidth/d.naturalHeight*1e3)/1e3),I(r,{width:Math.round(o/(t.frames-1)*100)+"%"}),o++,o<m.length?n(o):e())})};n(0)},L=function(t){var e=document.createElement("canvas");return e.classList.add("flipbook-canvas"),t.appendChild(e),e},C=function(){d=e.offsetWidth,f=Math.floor(d/t.aspectRatio);var i=innerHeight-f;l=f+i,n.width=d,n.height=f,n.style.top=Math.floor(i/2)+"px",o.style.height=l+"px",o.style.width=d+"px";var a=z();s=innerHeight*a,e.style.height=s+"px";var r=e.getBoundingClientRect();c=r.left,p=r.top+pageYOffset,u=r.bottom+pageYOffset-o.offsetHeight,Y(),H(pageYOffset-p,!0)},M=function(){O()},O=function(){g||requestAnimationFrame(Y),g=!0},Y=function(){if(g=!1,h){var t=pageYOffset-p,e=pageYOffset-u;t>0&&0>e?(I(o,{position:"fixed",top:0,left:c+"px",bottom:"auto"}),H(t)):e>0?(I(o,{position:"absolute",top:"auto",left:0,bottom:0}),H(s)):0>t&&(I(o,{position:"absolute",top:0,left:0,bottom:"auto"}),H(0))}},H=function(e,o){var n=e/(s-l);n=Math.min(Math.max(n,0),1);var i=Math.floor(n*(t.frames-1));(o||v!==i)&&(v=i,R(i))},R=function(t){i.clearRect(0,0,d,f),i.drawImage(m[t].img,0,0,d,f)},I=function(t,e){for(var o in e)t.style[o]=e[o]},z=function(){var e=10,o=2;return o+e*(1-t.speed)},B=function(t,e){var o=new Image;o.onload=function(){e(null,o)},o.onerror=function(){e("error loading image: "+t.src)},o.src=t.src},W=function(t){console&&console.error&&console.error("::flipbook:: "+t)};b()};return t});