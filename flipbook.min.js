!function(t){"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&module.exports?module.exports=t():window.flipbook=t.call(this)}(function(){var t=function(t){var e,n,o,i,a,r,f,s,d,l,c,u,p,m,h,g=-1,v=function(){var e,n=["id","path","extension","frames"];n.forEach(function(n){t[n]||(e=n)}),t.speed=t.speed||.5,e?W("invalid options, missing "+e):(w(),b(),E(function(t){t?W(W):x()}))},x=function(){p=!0,y(),C(),R(0),e.removeChild(a)},w=function(){e=document.getElementById(t.id),e.classList.add("flip-container"),a=document.createElement("div"),a.innerText="Loading animation...",a.classList.add("flip-loader"),e.appendChild(a),n=document.createElement("div"),n.classList.add("flip-graphic"),e.appendChild(n),o=L(n),i=o.getContext("2d")},b=function(){k(e,{position:"relative",width:"100%",overflow:"hidden"}),k(a,{"text-align":"center",padding:"1em","font-family":"sans-serif",color:"#666",background:"#efefef"}),k(n,{position:"absolute",top:0,left:0}),k(o,{position:"absolute",top:0,left:0})},y=function(){window.addEventListener("resize",C,!1),window.addEventListener("scroll",M,!1)},E=function(e){m=[];for(var n=0;n<t.frames;n++)m[n]={src:t.path+"/"+(n+1)+"."+t.extension};var o=function(n){var i=m[n];B(i,function(a,r){a?e("error loading image"):(i.img=r,0===n&&(t.aspectRatio=Math.round(r.naturalWidth/r.naturalHeight*1e3)/1e3),n++,n<m.length?o(n):e())})};o(0)},L=function(t){var e=document.createElement("canvas");return e.classList.add("flip-canvas"),t.appendChild(e),e},C=function(){r=e.offsetWidth,f=Math.floor(r/t.aspectRatio);var i=innerHeight-f;d=f+i,o.width=r,o.height=f,o.style.top=Math.floor(i/2)+"px",n.style.height=d+"px",n.style.width=r+"px";var a=I();s=innerHeight*a,e.style.height=s+"px";var p=e.getBoundingClientRect();l=p.left,c=p.top+pageYOffset,u=p.bottom+pageYOffset-n.offsetHeight,Y(),H(pageYOffset-c,!0)},M=function(){O()},O=function(){h||requestAnimationFrame(Y),h=!0},Y=function(){if(h=!1,p){var t=pageYOffset-c,e=pageYOffset-u;t>0&&0>e?(k(n,{position:"fixed",top:0,left:l+"px",bottom:"auto"}),H(t)):e>0?(k(n,{position:"absolute",top:"auto",left:0,bottom:0}),H(s)):0>t&&(k(n,{position:"absolute",top:0,left:0,bottom:"auto"}),H(0))}},H=function(e,n){var o=e/(s-d);o=Math.min(Math.max(o,0),1);var i=Math.floor(o*(t.frames-1));(n||g!==i)&&(g=i,R(i))},R=function(t){i.clearRect(0,0,r,f),i.drawImage(m[t].img,0,0,r,f)},k=function(t,e){for(var n in e)t.style[n]=e[n]},I=function(){var e=10,n=2;return n+e*(1-t.speed)},B=function(t,e){var n=new Image;n.onload=function(){e(null,n)},n.onerror=function(){e("error loading image: "+t.src)},n.src=t.src},W=function(t){console&&console.error&&console.error("::flipbook:: "+t)};v()};return t});